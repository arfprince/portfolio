name: PR Deploy Prompter

on:
  pull_request:
    types:
      - opened
      - reopened
      - synchronize

permissions:
  # Allow creating comments and reading pull request data jm
  pull-requests: write
  contents: read

jobs:
  comment-on-pr:
    runs-on: ubuntu-latest
    steps:
      - name: Post deploy checklist comment to PR
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const prNumber = context.payload.pull_request.number;
            const owner = context.repo.owner;
            const repo = context.repo.repo;

            const body = `### ðŸš€ Preview Deployment â€” choose services

            Hello! I can deploy preview environments for the services changed in this PR.

            **Two ways to request deployment (either one works):**

            **Use the checklist below** â€” edit the checklist and **check** items you want:
            - [ ] api
            - [ ] payment
            - [ ] dashboard
            - [ ] auth

            ---

            After you send the command or check boxes, I'll start the selected service workflows and report back here with progress.`;

                        // Create a comment
                        await github.rest.issues.createComment({
                        owner,
                        repo,
                        issue_number: prNumber,
                        body
                        });

                        console.log('Posted deploy checklist comment for PR #' + prNumber);
