name: PR Deploy Bot

on:
  pull_request:
    types: [opened, reopened, synchronize]

permissions:
  pull-requests: write
  contents: read

jobs:
  comment:
    runs-on: ubuntu-latest
    steps:
      - name: Post deploy instructions
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const pr = context.payload.pull_request.number;
            const repo = context.repo;

            const body = `
            ### ðŸš€ Preview Deployment

            To deploy services for this PR, add a comment:

            \`\`\`
            /deploy api
            \`\`\`

            Or multiple:

            \`\`\`
            /deploy api auth dashboard
            \`\`\`

            Available services:
            - api
            - auth
            - dashboard
            - payment
            - deploy
            `;

                        await github.rest.issues.createComment({
                        owner: repo.owner,
                        repo: repo.repo,
                        issue_number: pr,
                        body
                        });
